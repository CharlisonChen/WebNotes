Ajax

## 0x00 简介

- 服务器

  - 上网的目的 --- 通过互联网获取资源

  <img src="4.2.Ajax&AXIOS.assets/image-20220212164135189.png" alt="image-20220212164135189" style="zoom:57%;" />

  - URL --- Uniform Resource Locator
    - **统一资源定位符**，用于标识互联网上每个资源的唯一存放位置。
    - 浏览器只有通过URL地址，才能正确定位资源的存放位置，从而成功访问到对应的资源

  - URL 组成
    - 客户端与服务器之间的**通信协议** --- HTTP、ftp、File
    - 拥有该资源的**服务器名称** --- 俗称网址
    - 资源在该服务器上的**具体存放位置**


  <img src="4.2.Ajax&AXIOS.assets/image-20220212164521357.png" alt="image-20220212164521357" style="zoom:70%;" />

  - 客户端与服务器通信过程

  <img src="4.2.Ajax&AXIOS.assets/image-20220212164836717.png" alt="image-20220212164836717" style="zoom:57%;" />

  - 网页中的资源
    - 文字
    - 图片
    - 流媒体
    - 数据 --- 最重要
      - HTML、CSS、JavaScript 都是为 **数据** 服务的
  - 资源请求方式 --- XHR
    - 

- AJAX ---- **A**synchronous **J**avaScript **A**nd **X**ML

  - 异步的 JS 和 XML

  - 并不是编程语言，仅仅组合了
    
    - 浏览器内建的 XMLHTTPRequest 对象 ---- 从 Web 服务器请求数据
    
    - JS 和 DOM ---- 显示或使用数据

  - 优势 无刷新获取数据
    
    - 异步更新网页部分，而不需重新加载整个页面

  - 可用 XML、纯文本 或 JSON 传输数据

## 0x01 XML & JSON

### 简介

- XML ---- **EX**tensible **M**arkup **L**anguage
  
  - 可扩展标记语言
  
  - 设计来传输和存储数据
  
  - 没有预定义标签，需要自定义标签

```html
<!-- 以下均为自定义标签 用于表示数据 -->
<student>
    <name>PPY</name>
    <age>3</age>
    <gender>FEMALE</gender>
</student>
```

### 与 HTML 差异

1. 不是 HTML 的替代，是 HTML 的补充
2. HTML 用于显示信息 XML 用于传输信息
3. XML 被设计来传输和存储数据，焦点是数据的内容
4. HTML 被设计来显示数据，焦点是数据的外观

### JSON



## 0x02 缺点

1. 没有浏览历史，无法回退

2. 存在跨域问题 ---- 浏览器同源策略

3. SEO 不友好 ---- 搜索时还没有该数据

## 0x03 HTTP

### 简介

- 通信 --- 信息的**传递与交换**

  - 三要素 --- 主体 内容 方式

- **通信协议** --- Communication Protocol

  - 通信双方完成通信所**必须遵守的规则和约定**
  - 简单来说就是双方采用约定好的格式来发送和接收消息
  - 客户端与服务器要实现网页内容的传输，则通信双方必须遵守**网页内容的传输协议**
  - 网页内容又称超文本，因此网页内容的传输协议又称**超文本传输协议** --- HyperText Transfer Protocol
  - 简称 --- **HTTP 协议**

- HTTP 协议

  - 客户端要以 HTTP 协议要求的格式把数据**提交**到服务器
  - 服务器要以 HTTP 协议要求的格式把数据**响应**给客户端

  <img src="4.2.Ajax&AXIOS.assets/image-20220212235713235.png" alt="image-20220212235713235" style="zoom:67%;" />

### 请求

> 客户端发起的请求称 **HTTP 请求**
>
> 客户端发送给服务器的消息，称 **HTTP 请求消息**，又称 **HTTP 请求报文**

<img src="4.2.Ajax&AXIOS.assets/image-20220212235953438.png" alt="image-20220212235953438" style="zoom:80%;" />

- 组成

  - 请求行 --- request line

    - 由 请求方式、URL、HTTP 协议版本 3 个部分组成，用空格隔开

    ![image-20220213003514158](4.2.Ajax&AXIOS.assets/image-20220213003514158.png)

    <img src="4.2.Ajax&AXIOS.assets/image-20220213003545039.png" alt="image-20220213003545039" style="zoom:80%;" />

  - 请求头 --- header

    - 用于描述**客户端基本信息**，从而**把客户端信息告知服务器**
    - 由多行 **键值对** 组成

    ![image-20220213005425127](4.2.Ajax&AXIOS.assets/image-20220213005425127.png)

    <img src="4.2.Ajax&AXIOS.assets/image-20220213005402393.png" alt="image-20220213005402393" style="zoom:80%;" />

    - | **头部字段**    | **说明**                                         |
      | --------------- | ------------------------------------------------ |
      | Host            | 要请求的服务器域名                               |
      | Connection      | 客户端与服务器的连接方式( close  或  keepalive ) |
      | Content-Length  | 用来描述请求体的大小                             |
      | Accept          | 客户端可识别的响应内容类型列表                   |
      | User-Agent      | 产生请求的浏览器类型                             |
      | Content-Type    | 客户端告诉服务器实际发送的数据类型               |
      | Accept-Encoding | 客户端可接收的内容压缩编码形式                   |
      | Accept-Language | 用户期望获得的自然语言的优先顺序                 |

  - 空行

    - 位于最后一个请求头字段后，通知服务器 **请求头至此结束**
    - 请求消息中的空行，用于分隔 **请求头** 和 **请求体**


![image-20220213005823779](4.2.Ajax&AXIOS.assets/image-20220213005823779.png)

  - 请求体
    - 存放的是需通过 **POST 方式** 提交到服务器的数据
    - 只有 POST 请求才有了请求体，GET 请求没有请求体

![image-20220213115356789](4.2.Ajax&AXIOS.assets/image-20220213115356789.png)

### 响应

> 响应消息就是**服务器响应给服务端的消息内容**，也称响应报文

![image-20220213115601823](4.2.Ajax&AXIOS.assets/image-20220213115601823.png)

- 状态行
  - 由 HTTP 协议版本、状态码、状态码描述文本 三部分组成，由空格隔开

![image-20220213120138592](4.2.Ajax&AXIOS.assets/image-20220213120138592.png)

<img src="4.2.Ajax&AXIOS.assets/image-20220213120326718.png" alt="image-20220213120326718" style="zoom:80%;" />

  - 响应头
    - 描述**服务器的基本信息**，由 **键值对** 组成


![image-20220213120505799](4.2.Ajax&AXIOS.assets/image-20220213120505799.png)

<img src="4.2.Ajax&AXIOS.assets/image-20220213120556979.png" alt="image-20220213120556979" style="zoom:80%;" />

  - 空行
    - 最后一个响应头字段结束，紧跟一**空行**，表示**响应头至此结束**
    - 用于分隔响应头和响应体

![image-20220213121432432](4.2.Ajax&AXIOS.assets/image-20220213121432432.png)

  - 响应体
    - 服务器响应**给客户端的资源内容**

<img src="4.2.Ajax&AXIOS.assets/image-20220213122720200.png" alt="image-20220213122720200" style="zoom:80%;" />

### 请求方法

> 用于表明**要对服务器上资源进行的操作**
>
> 常用的是 POST GET

- HTTP 请求方法

| **序号** | **方法** | **描述**                                                     |
| -------- | -------- | ------------------------------------------------------------ |
| 1        | GET      | **(查询)** 发送请求来获得服务器上的资源，请求体中不会包含请求数据，请求数据放在协议头中。 |
| 2        | POST     | **(新增) **向服务器提交资源（例如提交表单或上传文件）。数据被包含在请求体中提交给服务器。 |
| 3        | PUT      | **(修改)** 向服务器提交资源，并使用提交的新资源，替换掉服务器对应的旧资源。 |
| 4        | DELETE   | **(删除)** 请求服务器删除指定的资源。                        |
| 5        | HEAD     | HEAD  方法请求一个与 GET 请求的响应相同的响应，但没有响应体。 |
| 6        | OPTIONS  | 获取 http 服务器支持的 http 请求方法，允许客户端查看服务器的性能，比如 ajax 跨域时的预检等。 |
| 7        | CONNECT  | 建立一个到由目标资源标识的服务器的隧道。                     |
| 8        | TRACE    | 沿着到目标资源的路径执行一个消息环回测试，主要用于测试或诊断。 |
| 9        | PATCH    | 是对  PUT 方法的补充，用来对已知资源进行局部更新 。          |

### 响应状态码

> HTTP Status Code 属于 HTTP 协议的一部分，**用于标识响应的状态**
>
> 状态码会随响应消息一起发送至客户端浏览器，浏览器根据状态码，就知道本次请求结果

<img src="4.2.Ajax&AXIOS.assets/image-20220213123527796.png" alt="image-20220213123527796" style="zoom:80%;" />

- 组成及分类
  - 由**三个数字组成**，第一个数字定义了**状态码类型**，后两个数字对状态码进行划分

| **分类** | **分类描述**                                                 |
| -------- | ------------------------------------------------------------ |
| 1**      | **信息**，服务器收到请求，需要请求者继续执行操作（实际开发中很少遇到  1**  类型的状态码） |
| 2**      | **成功**，操作被成功接收并处理                               |
| 3**      | **重定向**，需要进一步的操作以完成请求                       |
| 4**      | **客户端错误**，请求包含语法错误或无法完成请求               |
| 5**      | **服务器错误**，服务器在处理请求的过程中发生了错误           |

- 常见 HTTP 响应状态码

  - 2** 成功相关

    - 表示服务器已成功收到请求并进行处理

    | **状态码** | 状态码英文名称 | 中文描述                                                     |
    | :--------: | :------------: | ------------------------------------------------------------ |
    |  **200**   |     **OK**     | **请求成功。一般用于 GET 与 POST  请求**                     |
    |    201     |    Created     | 已创建。成功请求并创建了新的资源，通常用于 POST 或 PUT  请求 |

  - 3** 重定向相关

    - 表示服务器要求客户端重定向，需要客户端进一步操作以完成请求

    | **状态码** |   状态码英文名称   | 中文描述                                                     |
    | :--------: | :----------------: | ------------------------------------------------------------ |
    |    301     | Moved  Permanently | **永久移动**。请求的资源已被永久的移动到新 URI，返回信息会包括新的URI，浏览器会**自动定向到新 URI**。今后任何新的请求都应使用新的 URI 代替 |
    |    302     |       Found        | **临时移动**。与 301 类似。但资源只是临时被移动。客户端应继续使用原有 URI |
    |    304     |   Not  Modified    | **未修改**。所请求的资源未修改，服务器返回此状态码时，不会返回任何资源（响应消息中不包含响应体）。**客户端通常会缓存访问过的资源**。 |

  - 4** 客户端错误

    - 表示客户端**请求有非法内容**，导致本次请求失败

    | 状态码  | 状态码英文名称  | 中文描述                                                     |
    | :-----: | :-------------: | ------------------------------------------------------------ |
    |   400   |  Bad  Request   | 1. **语义有误**，当前请求无法被服务器理解。除非进行修改，否则客户端不应该重复提交这个请求。 <br />  2. **请求参数有误**。 |
    |   401   |  Unauthorized   | 当前请求**需要用户验证**。                                   |
    |   403   |    Forbidden    | 服务器已经理解请求，但是**拒绝执行**它。                     |
    | **404** |  **Not Found**  | **服务器无法根据客户端的请求找到资源（网页）。**             |
    |   408   | Request Timeout | 请求超时。服务器等待客户端发送的请求时间过长，**超时**。     |

  - 5** 服务端错误

    - 表示服务端未能正常处理客户端请求

    | 状态码  |     状态码英文名称     | 中文描述                                                     |
    | :-----: | :--------------------: | ------------------------------------------------------------ |
    |   500   | Internal  Server Error | 服务器内部错误，无法完成请求                                 |
    |   501   |    Not  Implemented    | 服务器不支持该请求方法，无法完成请求。只有  GET 和 HEAD  请求方法是要求每个服务器必须支持的，其它请求方法在不支持的服务器上会返回 501 |
    | **502** |    **Bad Gateway**     | **错误网关，常是服务器同时处理的请求超出负荷出现的错误**     |
    |   503   |  Service  Unavailable  | 由于超载或系统维护，服务器暂时的无法处理客户端的请求         |

